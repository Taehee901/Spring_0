<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="yedam.service.impl.BookMapper">

<insert id="insertBook" parameterType="bookVO">
	<!--   <selectKey keyProperty="bookNo" resultType="Long" order="BEFORE">
	   select book_seq.nextval from dual
	</selectKey>-->
	insert into BOOK_TBL_06 (
	  book_no, 
	  book_name, 
	  book_coverimg, 
	  book_date,
	  book_price,
	  book_publisher,
	  book_info
	)
	values (
	  #{bookNo}, 
	  #{bookName}, 
	  #{bookCoverimg}, 
	  #{bookDate},
	  #{bookPrice},
	  #{bookPublisher},
	  #{bookInfo}
	)
</insert>
<select id="bookList" resultType="bookVO">
	select book_no, 
		   book_name, 
		   book_coverimg, 
		   book_date,
		   book_price,
		   book_publisher,
		   book_info
	from   BOOK_TBL_06
</select>
<!--  단건조회 -->
<select id="bookDetail" parameterType="Long" resultType="bookVO">
	select book_no, 
		   book_name, 
		   book_coverimg, 
		   book_date,
		   book_price,
		   book_publisher,
		   book_info
	from   BOOK_TBL_06
	where  book_no = #{bookNo}
</select>
<select id="bookJoin" resultType="bookVO">
	select b.book_no,
       b.book_name,
      SUM(r.rent_price) As rent_price,  
      COUNT(r.rent_status) AS rent_status
from   book_tbl_06 b
join  rent_tbl_06 r on b.BOOK_NO = r.book_no
group by 
    b.book_no, b.book_name
order by b.book_no
</select>

<!-- 삭제 -->
<delete id="bookRemove" parameterType="Long">
	delete from BOOK_TBL_06  where book_no = #{bookNo}
</delete>

<select id="selectBookNextVal" resultType="long">
    SELECT books_seq.nextval FROM dual
</select>
</mapper>